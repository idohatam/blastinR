% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/retrieve_hit_seqs.R
\name{retrieve_hit_seqs}
\alias{retrieve_hit_seqs}
\title{Retrieve Hit Sequences from BLAST Search Results}
\usage{
retrieve_hit_seqs(
  query_ids,
  blast_results,
  blastdb,
  NumHitseqs = 1,
  outfile,
  cut_seq = TRUE,
  MultFiles = FALSE,
  report = TRUE,
  pipeline = FALSE
)
}
\arguments{
\item{query_ids}{A character vector of query sequence IDs to retrieve hits for.}

\item{blast_results}{A data frame containing BLAST+ output (e.g., from \code{blstinr()}), including \code{sseqid}, \code{sstart}, and \code{send} columns.}

\item{blastdb}{A character string specifying the path/name of the BLAST database.}

\item{NumHitseqs}{Integer. Number of hit sequences to retrieve per query ID. Default is 1.}

\item{outfile}{A character string for the output file name (excluding file extension).}

\item{cut_seq}{Logical. If \code{TRUE} (default), retrieves only the aligned portion of each hit. If \code{FALSE}, retrieves the full sequence.}

\item{MultFiles}{Logical. If \code{TRUE}, saves each queryâ€™s hits to a separate FASTA file. Default is \code{FALSE}, saving all hits to a single file.}

\item{report}{Logical. If \code{TRUE} (default), results will be logged in the HTML report.}

\item{pipeline}{Logical. If \code{TRUE}, returns output file names instead of sequences, useful when chaining steps programmatically. Default is \code{FALSE}.}
}
\value{
A character vector of sequences (if \code{pipeline = FALSE}) or output file names (if \code{pipeline = TRUE}).
}
\description{
This function retrieves the hit sequences from a BLAST search, optionally trimming them to
just the aligned region. It allows for multiple hit retrievals per query and supports
exporting results to individual or combined FASTA files. This is useful when working with
large genomes where only the matched segment is desired.
}
\examples{
\dontrun{
  # Example usage after running a blast search with blstinr()
  blast_results <- read.csv("outputs/table/my_blast_results.csv")
  sequences <- retrieve_hit_seqs(
    query_ids = c("query1", "query2"),
    blast_results = blast_results,
    blastdb = "my_blast_db",
    NumHitseqs = 2,
    outfile = "retrieved_hits"
  )
  cat(sequences, sep = "\n")
}
}
